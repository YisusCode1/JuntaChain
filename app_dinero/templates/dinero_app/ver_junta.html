{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Junta Creada</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body>

    <!-- ======= ENCABEZADO ======= -->
    <header>
        <div class="logo">
            <h1>ğŸ’° Junta Virtual</h1>
        </div>
        <nav>
            <ul>
                <li><a href="/">Inicio</a></li>
                <li><a href="/crear_junta">Crear Junta</a></li>
                <li><a href="/unirse">Unirse</a></li>
            </ul>
        </nav>
        <div class="wallet-container">
            <button class="btn-wallet">Conectar Wallet</button>
        </div>
    </header>

    <!-- ======= CONTENIDO PRINCIPAL ======= -->
    <main class="main-content">
        <h1>ğŸ‰ Â¡Junta Creada Exitosamente!</h1>

        <div class="wallet-info">
            <p><strong>CÃ³digo de Junta:</strong> {{ juntaData.codigo }}</p>
            <p><strong>NÃºmero de Participantes:</strong> {{ juntaData.numero_participantes }}</p>
            <p><strong>Cantidad a Aportar:</strong> {{ juntaData.cantidad_aporte }} ETH</p>
            <p><strong>DirecciÃ³n del Organizador:</strong> {{ juntaData.direccion_organizador }}</p>
            <p><strong>Fecha de CreaciÃ³n:</strong> {{ juntaData.fecha_creacion }}</p>
        </div>

        {% if juntaData.contract_address %}
            <p><strong>ğŸ“œ Contrato:</strong> 
                <a href="https://sepolia.etherscan.io/address/{{ juntaData.contract_address }}" target="_blank">
                    {{ juntaData.contract_address }}
                </a>
            </p>
        {% else %}
            <p style="color:gray;">âš ï¸ Esta junta aÃºn no tiene contrato asignado.</p>
        {% endif %}

        <h2>ğŸ“¢ Comparte este cÃ³digo con los participantes</h2>
        <div class="codigo">
            <input type="text" value="{{ juntaData.codigo }}" readonly id="codigoJunta">
            <button class="wallet-btn" onclick="copiarCodigo()">ğŸ“‹ Copiar CÃ³digo</button>
        </div>

        <hr>

        <h2>ğŸ’° Pagos de Colateral</h2>
        <p>Cuando cada participante pague su colateral, aparecerÃ¡ un âœ”ï¸ de validaciÃ³n.</p>

        <div id="contenedorPagos"></div>

        <br>

        <!-- ğŸ”¹ BotÃ³n de Aporte -->
        <button id="btnAporte" class="btn-principal" disabled>ğŸ’¸ Aporte</button>

        <!-- ğŸ”¹ Temporizador (inicialmente oculto) -->
        <div id="temporizador" style="display:none; font-weight: bold; color: #e63946; margin-top: 15px;">
            â³ Tiempo restante: 48:00:00
        </div>
    </main>

    <!-- ======= SCRIPTS ======= -->
    <script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ethers@6.6.0/dist/ethers.umd.min.js"></script>

    <!-- âœ… Pasamos juntaData directamente desde Django al JS -->
    <script>
        const juntaData = {{ juntaData|safe }};
        
        function copiarCodigo() {
            const input = document.getElementById("codigoJunta");
            input.select();
            document.execCommand("copy");
            alert("ğŸ“‹ CÃ³digo copiado al portapapeles");
        }
    </script>

    <!-- Tu archivo JS que maneja el contrato -->
    <script src="{% static 'js/ver_junta.js' %}"></script>
</body>
</html>


